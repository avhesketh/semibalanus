wide.temp.trace
wide.temp.trace <- ggplot(data = temp.summary %>% filter(date >= "2021-05-01" & date < "2021-08-15") , aes(x = date, y = mean.max.temp, col = treatment, fill = treatment)) + geom_line() + theme_bw() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean daily max aerial temperature (ºC)", color = "Treatment", fill = "Treatment") + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_ribbon(aes(ymax = mean.max.temp + se.max.temp, ymin = mean.max.temp - se.max.temp), alpha = 0.3, color = NA) + annotate("rect", xmin = ymd("2021-06-25"), xmax = ymd("2021-06-29"), ymin = min(mean.max.temp - se.max.temp), ymax = max(mean.max.temp + se.max.temp), fill = "black",  col = "black", alpha = 0.1)
wide.temp.trace <- ggplot(data = temp.summary %>% filter(date >= "2021-05-01" & date < "2021-08-15") , aes(x = date, y = mean.max.temp, col = treatment, fill = treatment)) + geom_line() + theme_bw() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean daily max aerial temperature (ºC)", color = "Treatment", fill = "Treatment") + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_ribbon(aes(ymax = mean.max.temp + se.max.temp, ymin = mean.max.temp - se.max.temp), alpha = 0.3, color = NA) + annotate("rect", xmin = ymd("2021-06-25"), xmax = ymd("2021-06-29"), ymin = 5, ymax = 45, fill = "black",  col = "black", alpha = 0.1)
wide.temp.trace
wide.temp.trace <- ggplot(data = temp.summary %>% filter(date >= "2021-05-01" & date < "2021-08-15") , aes(x = date, y = mean.max.temp, col = treatment, fill = treatment)) + geom_line() + theme_bw() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean daily max aerial temperature (ºC)", color = "Treatment", fill = "Treatment") + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_ribbon(aes(ymax = mean.max.temp + se.max.temp, ymin = mean.max.temp - se.max.temp), alpha = 0.3, color = NA) + annotate("rect", xmin = ymd("2021-06-25"), xmax = ymd("2021-06-29"), ymin = 10, ymax = 45, fill = "black",  col = NA, alpha = 0.1)
wide.temp.trace
wide.temp.trace <- ggplot(data = temp.summary %>% filter(date >= "2021-05-01" & date < "2021-08-15") , aes(x = date, y = mean.max.temp, col = treatment, fill = treatment)) + geom_line() + theme_bw() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean daily max aerial temperature (ºC)", color = "Treatment", fill = "Treatment") + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_ribbon(aes(ymax = mean.max.temp + se.max.temp, ymin = mean.max.temp - se.max.temp), alpha = 0.3, color = NA) + annotate("rect", xmin = ymd("2021-06-25"), xmax = ymd("2021-06-29"), ymin = 10, ymax = 45, fill = "black",  col = NA, alpha = 0.3)
wide.temp.trace
temp.traces <- wide.temp.trace / heat.dome.trace + plot_layout(guides = 'collect') + plot_annotation(tag_levels = "A") & theme(plot.tag = element_text(size = 16, face = "bold"), plot.tag.position = c(-0.03,1), plot.margin = margin(t=5,b=5,l=15,r=5, "pt"))
ggsave(temp.traces, filename = "../outputs/S1Fig3.png", height = 6, width = 7, units = "in", scale = 1.3, dpi = 1200)
heat.dome.trace <- ggplot(data = temp.hw, aes(x = date_time, y = mean.temp, col = treatment, fill = treatment)) + geom_line() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Temperature (ºC)", fill = "Treatment", color = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_ribbon(aes(ymax = mean.temp + se.temp, ymin = mean.temp - se.temp), alpha = 0.3, color = NA)
heat.dome.trace
temp.traces <- wide.temp.trace / heat.dome.trace + plot_layout(guides = 'collect') + plot_annotation(tag_levels = "A") & theme(plot.tag = element_text(size = 16, face = "bold"), plot.tag.position = c(-0.03,1), plot.margin = margin(t=5,b=5,l=15,r=5, "pt"))
ggsave(temp.traces, filename = "../outputs/S1Fig3.png", height = 6, width = 7, units = "in", scale = 1.3, dpi = 1200)
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","mediumorchid2", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","mediumorchid4", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","darkmorchid4", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","darkorchid4", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","darkslateblue", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","purple2", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","blueviolet", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","purple4", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","purple3", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","purple2", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","darkorchid2", "goldenrod")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","gold3", "palegreen4")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
View(site_info)
low_tide_hot_hour <- ggplot(aes(x = low_time, y = hottest_hour, col = site), data = all.regressions) +
geom_point()+
facet_wrap(~ site) +
geom_smooth(method = "lm") +
theme_bw() +
theme(legend.position = "none", axis.title = element_text(size = 14),
axis.text = element_text(size = 12), strip.text = element_text(size = 14)) +
geom_text(aes(x = 14.5, y = 17.8, label = eqn), col = "black", size = 5) +
geom_text(aes(x = 16, y = 10.05), label = expression(R^2~"="), col = "black", size = 5) +
geom_text(aes(x = 20.5, y = 10, label = r2), col = "black", size = 5) +
scale_color_manual(values = c("steelblue","#CEAA07","#6E8243")) +
labs(y = "Hour of maximum on-shore temperature", x = "Hour of lowest low tide")
low_tide_hot_hour
ggsave(filename = "./outputs/S1Fig2.png", dpi = 1200, low_tide_hot_hour)
infauna.ordination <- ggplot() +
geom_point(data=data.scores,aes(x=NMDS1,y=NMDS2,colour=site_code),size=3, alpha = 0.8) + # add the point markers
geom_text(data=species.scores,aes(x=NMDS1,y=NMDS2,label=species),size = 3, alpha=0.7) +
coord_equal() +
theme_bw() +
scale_color_manual(values = col.levels) +
geom_segment(aes(x = NMDS1, y = NMDS2, xend = mean.x, yend = mean.y, col = site_code), data = data.scores, alpha = 0.7) +
geom_text(data=data.scores,aes(x=mean.x, mean.y,label=site_code),size=4, alpha = 0.7, col = "grey20" ) +  # add the site labels
#geom_text(aes(x = 0.9, y = 0.6, label = paste("Stress = ", round(comm.infauna$stress,4))),cex = 4) +
labs(color = "Site code", x = "Axis 1", y = "Axis 2") +
theme(axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
infauna.ordination
data.scores <- as.data.frame(scores(comm.infauna))
data.scores$site_code <- infauna.summer$site_code
data.scores$color <- infauna.summer$full.pal
palette <- site_info %>% select(site_code, full.pal)
# filter by time: only collections made at the end of summer 2021 (NOT 1 and 2)
infauna.summer <- infauna.clean %>% filter(collection_number %in% 3:12) %>% left_join(palette)
col.levels <- infauna.summer$full.pal %>% unique()
site.levels <- infauna.summer$site_code %>% unique()
data.scores <- as.data.frame(scores(comm.infauna))
data.scores$site_code <- infauna.summer$site_code
data.scores <- data.scores %>% group_by(site_code) %>% mutate(mean.x = mean(NMDS1), mean.y = mean(NMDS2)) %>% ungroup() %>% mutate(site_code = factor(site_code, levels = site.levels))
infauna.ordination <- ggplot() +
geom_point(data=data.scores,aes(x=NMDS1,y=NMDS2,colour=site_code),size=3, alpha = 0.8) + # add the point markers
geom_text(data=species.scores,aes(x=NMDS1,y=NMDS2,label=species),size = 3, alpha=0.7) +
coord_equal() +
theme_bw() +
scale_color_manual(values = col.levels) +
geom_segment(aes(x = NMDS1, y = NMDS2, xend = mean.x, yend = mean.y, col = site_code), data = data.scores, alpha = 0.7) +
geom_text(data=data.scores,aes(x=mean.x, mean.y,label=site_code),size=4, alpha = 0.7, col = "grey20" ) +  # add the site labels
#geom_text(aes(x = 0.9, y = 0.6, label = paste("Stress = ", round(comm.infauna$stress,4))),cex = 4) +
labs(color = "Site code", x = "Axis 1", y = "Axis 2") +
theme(axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
infauna.ordination
ggsave(filename = "../outputs/S1Fig1.png", infauna.ordination, dpi = 1200)
temp.summary2 <- temp.sep %>% group_by(treatment, date) %>% summarize(mdmax_temp = max(temperature_C)) %>% mutate(trt_long = case_when(treatment == "SI" ~ "shaded intact", treatment == "UI" ~ "unshaded intact", treatment == "SR" ~ "shaded removal", treatment == "UR" ~ "unshaded removal"))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = trt_long)) + geom_boxplot() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean maximum daily temperature (ºC)", color = "Treatment") + theme_bw()
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot() + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Date", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
temp.boxplot <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
temp.boxplot <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
install.packages("ggsignif")
library(ggsignif)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_signif()
temp.summary2 <- temp.sep %>% group_by(treatment, date) %>% summarize(mdmax_temp = max(temperature_C)) %>% mutate(trt_long = case_when(treatment == "SI" ~ "shaded intact", treatment == "UI" ~ "unshaded intact", treatment == "SR" ~ "shaded removal", treatment == "UR" ~ "unshaded removal")) %>% mutate(shading = substr(treatment,1,1), removal = substr(treatment,2,2))
temp.model <- lmer(temperature_C ~ treatment*date_time + (1|block), data = temp.lowtide)
summary(temp.model)
Anova(temp.model)
max.temp.model <- lm(mdmax_temp ~ treatment, data = temp.summary2)
TukeyHSD(aov(mdmax_temp ~ treatment, data = temp.summary2))
summary(max.temp.model)
Anova(max.temp.model)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = shading, y = mdmax_temp, group = removal, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + annotate()
View(temp.summary2)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = shading, y = mdmax_temp, group = removal, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3, position = "dodge") + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + annotate()
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = shading, y = mdmax_temp, group = removal, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3, position = "dodge") + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = shading, y = mdmax_temp, group = removal, col = shading, fill = treatment)) + geom_boxplot(alpha = 0.3, position = "dodge") + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = shading, y = mdmax_temp, group = removal, col = removal, fill = treatment)) + geom_boxplot(alpha = 0.3, position = "dodge") + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 0.45, xend = 0.25))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 0.45, xend = 0.25, y = 40, yend = 40))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2, xend = 0.45, y = 50, yend = 50))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", aes(x = 2.5, y = 50, value = "***"))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", aes(x = 2.5, y = 50, label = "***"))
?annotate
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 50, label = "***")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***") + geom_segment(aes(x = 2.6, xend = 4, y = 50, yend = 50), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***") + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***") + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 45, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***") + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***") + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 12) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 10) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 8) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.4, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 4) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.55, y = 49.7, label = "***", size = 5) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.65, y = 49.7, label = "***", size = 5) + geom_segment(aes(x = 2.6, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 5) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.7, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
max.temp.model <- lm(mdmax_temp ~ shading + removal, data = temp.summary2)
TukeyHSD(aov(mdmax_temp ~ treatment, data = temp.summary2))
max.temp.model <- lm(mdmax_temp ~ shading + removal, data = temp.summary2)
summary(max.temp.model)
Anova(max.temp.model)
max.temp.model <- lmer(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2)
temp.summary2 <- temp.sep %>% group_by(treatment, date, block) %>% summarize(mdmax_temp = max(temperature_C)) %>% mutate(trt_long = case_when(treatment == "SI" ~ "shaded intact", treatment == "UI" ~ "unshaded intact", treatment == "SR" ~ "shaded removal", treatment == "UR" ~ "unshaded removal")) %>% mutate(shading = substr(treatment,1,1), removal = substr(treatment,2,2))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
max.temp.model <- lmer(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2)
summary(max.temp.model)
Anova(max.temp.model)
max.temp.model.norand <- lmer(mdmax_temp ~ shading + removal, data = temp.summary2)
max.temp.model.norand <- glm(mdmax_temp ~ shading + removal, data = temp.summary2)
AIC(max.temp.model, max.temp.model.norand)
max.temp.model.norand <- gls(mdmax_temp ~ shading + removal, data = temp.summary2)
AIC(max.temp.model, max.temp.model.norand)
summary(max.temp.model)
TukeyHSD(aov(mdmax_temp ~ treatment, data = temp.summary2))
plot(simulateResiduals(max.temp.model))
max.temp.model <- lmer(log(mdmax_temp) ~ shading + removal + (1|block), data = temp.summary2)
plot(simulateResiduals(max.temp.model)) # need to solve homoscedatisicity problems
Anova(max.temp.model)
max.temp.model <- lmer(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2)
plot(simulateResiduals(max.temp.model)) # need to solve homoscedatisicity problems
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2, dispformula = ~shading )
plot(simulateResiduals(max.temp.model.glmm))
summary(max.temp.model.glmm)
Anova(max.temp.model.glmm)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_point()
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.3) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
photo.plot <- ggdraw() + draw_image(infauna.photo) + theme(plot.margin = margin(0,0,0,0))
# load packages
pkgs <- c("vegan", "vegan3d", "tidyverse", "RColorBrewer", "plotrix", "glmmTMB", "viridis", "patchwork", "magick", "ggpubr")
lapply(pkgs, library, character = T)
rm(pkgs)
photo.plot <- ggdraw() + draw_image(infauna.photo) + theme(plot.margin = margin(0,0,0,0))
library(cowplot)
photo.plot <- ggdraw() + draw_image(infauna.photo) + theme(plot.margin = margin(0,0,0,0))
infauna.photo <- image_convert(image_read("../infauna.jpg"), "png")
photo.plot <- ggdraw() + draw_image(infauna.photo) + theme(plot.margin = margin(0,0,0,0))
Fig2 <- (richness.plot | diversity.plot) / (barplot.abund | photo.plot) +
plot_annotation(tag_levels = "A") & theme(plot.tag =element_text(size = 26, face = "bold"))
ggsave(Fig2, filename = "../outputs/Fig2.png", dpi = 1200, height = 5, width = 7, units = "in", scale = 2.5)
pal <- wes_palette("Darjeeling2", n = 16, type = "continuous")
# load packages
pkgs <- c("vegan", "vegan3d", "tidyverse", "RColorBrewer", "plotrix", "glmmTMB", "viridis", "patchwork", "magick", "ggpubr", "wesanderson")
lapply(pkgs, library, character = T)
rm(pkgs)
pal <- wes_palette("Darjeeling2", n = 16, type = "continuous")
infauna.clean.coarse <- infauna.all.coarse %>%
separate(file_name, c("code", "data", "collection_number"), sep = "_") %>% select(-code, -data) %>% mutate(collection_number = as.numeric(str_remove_all(collection_number, ".csv"))) %>% left_join(collection.info) %>% filter(collection_number %in% c(3:12)) %>% select(-collection_date, -collection_number) %>% mutate(site_code = factor(site_code, levels = site.levels), coarse_grouping = fct_reorder(coarse_grouping, mean.abund, max))
barplot.abund <- ggplot(aes(x = site_code, fill = coarse_grouping, y = mean.abund),
data = infauna.clean.coarse) +
geom_bar(position = "stack", stat = "identity", col = "grey50", lwd = 0.2, width = 0.8) +
theme_classic() +
labs(y = "Mean abundance", x = "Collection site", fill = "Taxon") +
scale_fill_discrete(type = pal) +
theme(axis.title = element_text(size = 24), axis.text = element_text(size = 20),
legend.title=element_text(size = 24), legend.text = element_text(size = 20))
Fig2 <- (richness.plot | diversity.plot) / (barplot.abund | photo.plot) +
plot_annotation(tag_levels = "A") & theme(plot.tag =element_text(size = 26, face = "bold"))
ggsave(Fig2, filename = "../outputs/Fig2.png", dpi = 1200, height = 5, width = 7, units = "in", scale = 2.5)
ggsave(Fig2, filename = "../outputs/Fig2.png", dpi = 1200, height = 5, width = 7, units = "in", scale = 3)
ggsave(Fig2, filename = "../outputs/Fig2.png", dpi = 1200, height = 5, width = 7, units = "in", scale = 2)
ggsave(Fig2, filename = "../outputs/Fig2.png", dpi = 1200, height = 5, width = 7, units = "in", scale = 2.5)
knitr::opts_chunk$set(echo = TRUE)
Anova(mort.mod.1)
pkgs <- c("tidyverse", "glmmTMB", "DHARMa","lme4","car","ggeffects", "GGally")
lapply(pkgs, library, character=T)
lapply(pkgs, library, character=T)
rm(pkgs)
?apply
pkgs <- c("tidyverse", "glmmTMB", "DHARMa","lme4","car","ggeffects", "GGally")
apply(pkgs, library, character=T)
apply(pkgs, function = library, character=T)
apply(pkgs, FUN = library, character=T)
apply(pkgs, FUN = "library", character=T)
?lapply
pkgs <- c("tidyverse", "glmmTMB", "DHARMa","lme4","car","ggeffects", "GGally")
sapply(pkgs, library, character=T)
vapply(pkgs, library, character=T)
invisible(lapply(pkgs, library, character=T))
rm(pkgs)
Anova(mort.mod.1)
library(tidyverse)
taxa <- read_csv("../raw_data/SBHW_taxonomic_20220105.csv") %>%  select(original_code, final_code)
plots <- read_csv("../raw_data/shade/SBHW_SHADE_plot_info.csv")
collections <- read_csv("../raw_data/infauna/SBHW_INFAUNA_collections.csv")
library(glmmTMB)
library(DHARMa)
library(car)
barnacles <- all_visuals %>% filter(final_code %in% c("BAGL","CHDA", "SECA") & treatment %in% c(3, 4)) %>% mutate(date = as.Date(date))
summary.bncles <- all_visuals %>% group_by(date) %>% summarize(bncle_total = sum(abund))
recruitment.peak <- barnacles %>% filter(date == "2021-07-07" | date == "2021-07-08") %>% group_by(plot_number, treatment_code) %>% summarize(total_abund = sum(abund)) %>% mutate(trt_long = case_when(treatment_code == "SR" ~ "shaded removal", treatment_code == "UR" ~ "unshaded removal"))
ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
barnacle.mort <- read_csv("../raw_data/shade/SBHW_SHADE_semibalanusmort.csv") %>% mutate(prop_mort = (number_dead)/(number_live+number_dead)) %>% filter(prop_mort != "NaN")
plot.info <- read_csv("../raw_data/shade/SBHW_SHADE_plot_info.csv")
mort.complete <- barnacle.mort %>% left_join(plot.info) %>% filter((plot_number %in% c(15,35,36,40)) == F) %>% select(prop_mort, treatment_original_numeric, plot_number, block) %>% rename(treatment = treatment_original_numeric) %>% mutate(treatment = case_when(treatment == 1 ~ "UI", treatment == 2 ~ "SI"))
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI"))
shade.mort.model <- glm(prop_mort ~ treatment, family = "binomial", data = mort.beds)
plot(shade.mort.model)
shade.mort.model.weights <- glm(prop_mort ~ treatment, family = "binomial", weights = treatment, data = mort.beds %>% mutate(treatment = case_when(treatment == "UI" ~ 1, treatment == "SI" ~ 2)))
AIC(shade.mort.model, shade.mort.model.weights)
summary(shade.mort.model)
Anova(shade.mort.model)
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_bw() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black") + geom_jitter(width = 0.2, alpha = 0.2)
max.temp.model <- lmer(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2)
plot(simulateResiduals(max.temp.model)) # need to solve homoscedatisicity problems
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading + removal + (1|block), data = temp.summary2, dispformula = ~shading)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
max.temp.model <- lmer(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2)
plot(simulateResiduals(max.temp.model)) # need to solve homoscedatisicity problems
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~shading)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
# scale the predictors?
library(standardize)
# scale the predictors?
update(standardize)
# scale the predictors?
update("standardize")
# scale the predictors?
update.packages("standardize")
# scale the predictors?
library(standardize)
# scale the predictors?
mort.model.scaled <- mort.model.df %>% mutate(
temp.scaled = scale(mean_daily_max_temp_hw),
tide.scaled = scale(mean_low_tide_time),
algae.scaled = scale(algal_prop_cover),
angle.scaled = scale(degrees_from_north)
)
# scale the predictors?
mort.model.scaled <- mort.model.df %>% mutate(
temp.scaled = scale(mean_daily_max_temp_hw),
tide.scaled = scale(mean_low_tide_time),
algae.scaled = scale(algal_prop_cover),
angle.scaled = scale(degrees_from_north),
mort.tr = (prop_dead*nrow(mort.model.df)+0.5)/nrow(mort.model.df)
)
mort.model.3 <- glmmTMB(mort.tr ~ temp.scaled + tide.scaled + algae.scaled + angle.scaled +
(1 | site_code/transect), data = mort.model.scaled, family = beta_family())
plot(simulateResiduals(mort.model.3))
mort.model.3 <- glmmTMB(mort.tr ~ temp.scaled + tide.scaled + algae.scaled + angle.scaled + (1 | site_code/transect), data = mort.model.scaled, family = Tweedie())
mort.model.3 <- glmmTMB(mort.tr ~ temp.scaled + tide.scaled + algae.scaled + angle.scaled + (1 | site_code/transect), data = mort.model.scaled, family = tweedie)
mort.model.3 <- glmmTMB(prop_dead ~ temp.scaled + tide.scaled + algae.scaled + angle.scaled + (1 | site_code/transect), data = mort.model.scaled, family = tweedie)
plot(simulateResiduals(mort.model.3))
summary(mort.model.3)
Anova(mort.model.3)
Anova(max.temp.model.glmm, type = "III")
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~0)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~shading+removal)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
summary(max.temp.model.glmm)
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~removal)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
max.temp.model.glmm.1 <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~shading+removal)
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~shading)
AIC(max.temp.model.glmm, max.temp.model.glmm.1)
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2)
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
AIC(max.temp.model.glmm, max.temp.model.glmm.1)
max.temp.model.glmm <- glmmTMB(mdmax_temp ~ shading*removal + (1|block), data = temp.summary2, dispformula = ~shading+removal)
plot(simulateResiduals(max.temp.model.glmm)) # problem solved!
summary(max.temp.model.glmm)
Anova(max.temp.model.glmm, type = "III")
Anova(max.temp.model.glmm, type = 3)
?Anova
Anova(max.temp.model.glmm, type = 3, test.statistic = "F")
Anova(max.temp.model.glmm, type = 3, test.statistic = "LR")
Anova(max.temp.model.glmm, type = 3, test.statistic = "F")
Anova(max.temp.model.glmm, type = 2, test.statistic = "F")
Anova(max.temp.model.glmm, type = 3)
summary(shade.mort.model)
shade.mort.model <- glmmTMB(prop_mort ~ treatment + (1|block), family = "binomial", data = mort.beds)
plot(shade.mort.model)
plot(simulateResiduals(shade.mort.model))
shade.mort.model <- glmmTMB(prop_mort ~ treatment + (1|block), dispformula = ~treatment, family = "binomial", data = mort.beds)
plot(simulateResiduals(shade.mort.model))
shade.mort.model <- glmmTMB(prop_mort ~ treatment + (1|block), dispformula = ~treatment, family = tweedie, data = mort.beds)
plot(simulateResiduals(shade.mort.model))
shade.mort.model <- glmmTMB(prop_mort ~ treatment + (1|block), dispformula = ~treatment, family = "quasibinomial", data = mort.beds)
View(mort.beds)
hist(mort.beds$prop_mort)
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI")) %>%
mutate(mort.tr = (prop_mort*nrow(mort.complete)+0.5)/nrow(mort.complete))
shade.mort.model <- glmmTMB(mort.tr ~ treatment + (1|block), dispformula = ~treatment, family = "binomial", data = mort.beds)
View(mort.beds)
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI")) %>%
mutate(mort.tr = (prop_mort*nrow(mort.complete)-0.5)/nrow(mort.complete))
mutate(mort.tr = (1- (prop_mort*nrow(mort.complete)+0.5)/nrow(mort.complete))
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI")) %>%
mutate(mort.tr = (1- (prop_mort*nrow(mort.complete)+0.5))/nrow(mort.complete))
mutate(mort.tr = ((1-prop_mort*nrow(mort.complete)+0.5)/nrow(mort.complete))
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI")) %>%
mutate(mort.tr = (1-prop_mort*nrow(mort.complete)+0.5)/nrow(mort.complete))
mort.beds <- mort.complete %>% filter(treatment %in% c("SI","UI")) %>%
mutate(mort.tr = (prop_mort*(nrow(mort.complete)-1)+0.5)/nrow(mort.complete))
shade.mort.model <- glmmTMB(mort.tr ~ treatment + (1|block), dispformula = ~treatment, family = "beta", data = mort.beds)
shade.mort.model <- glmmTMB(mort.tr ~ treatment + (1|block), dispformula = ~treatment, family = beta_family(), data = mort.beds)
plot(simulateResiduals(shade.mort.model))
Anova(shade.mort.model)
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "shaded", treatment == "UI" ~ "unshaded")), aes(x = treatment, y = prop_mort, col = treatment)) + geom_boxplot() + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme(legend.position = "none")
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual( values = c("skyblue4", "tomato4")) labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, points = T) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
View(RP_tides)
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue2", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_jitter(width = 0.2, alpha = 0.2) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_jitter(width =) geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = "Mortality (%)",col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = expression("Proportion"~italic("S. cariosus")~"dead"),col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
fig5b <- ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = expression("Proportion"~italic("S. cariosus")~"dead"),col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long)) + geom_boxplot() + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue2", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long)) + geom_boxplot(alpha = 0.4) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue2", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue2", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
fig5a
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4) + scale_color_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_jitter(width = 0.2, alpha = 0.2) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
fig5a
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4) + geom_jitter(width = 0.2, alpha = 0.2) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4) + geom_jitter(width = 0.2, alpha = 0.2, col = "black") + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, outlier.size = 0) + scale_color_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_jitter(width = 0.2, alpha = 0.2) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
fig5b <- ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, outlier.size = 0) + theme_bw() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = expression("Proportion"~italic("S. cariosus")~"dead"),col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
fig5b <- ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, outlier.size = 0) + theme_classic() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = expression("Proportion"~italic("S. cariosus")~"dead"),col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.2)
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4, outlier.size = 0) + geom_jitter(width = 0.2, alpha = 0.2) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4, outlier.shape = NA) + geom_jitter(width = 0.2, alpha = 0.2) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
ggplot(recruitment.peak, aes(x = treatment_code, y = total_abund, fill = trt_long, col = trt_long)) + geom_boxplot(alpha = 0.4, outlier.shape = NA) + geom_jitter(width = 0.2, alpha = 0.3) + labs(x = "Treatment", y = "Total barnacle abundance", fill = "Treatment") + theme_classic() + scale_fill_manual(values = c("skyblue3", "tomato2")) + scale_color_manual(values = c("skyblue3", "tomato2")) + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none")
fig5b <- ggplot(mort.beds %>% mutate(treatment = case_when(treatment == "SI" ~ "Shaded", treatment == "UI" ~ "Unshaded")), aes(x = treatment, y = prop_mort, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, outlier.size = NA) + theme_classic() + scale_color_manual( values = c("skyblue4", "tomato4")) + scale_fill_manual(values = c("skyblue4", "tomato4")) + labs(x = "Treatment", y = expression("Proportion"~italic("S. cariosus")~"dead"),col = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.position = "none") + geom_jitter(width = 0.2, alpha = 0.3)
fig5a <- ggplot(data = temp.summary2 %>% filter(mdmax_temp < 50), aes(x = treatment, y = mdmax_temp, col = treatment, fill = treatment)) + geom_boxplot(alpha = 0.4, outlier.size = NA) + scale_color_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + scale_fill_manual(values = c("skyblue4","skyblue3", "tomato4", "tomato2")) + labs(x = "Treatment", y = "Mean maximum daily temperature (ºC)", color = "Treatment", fill = "Treatment") + theme_classic() + theme(axis.title = element_text(size = 14), axis.text = element_text(size = 12), legend.text = element_text(size = 12), legend.title = element_text(size = 14)) + geom_jitter(width = 0.2, alpha = 0.2) #+ geom_segment(aes(x = 2.35, xend = 1.5, y = 50, yend = 50), col = "black") + annotate("text", x = 2.5, y = 49.5, label = "***", size = 6) + geom_segment(aes(x = 2.65, xend = 3.5, y = 50, yend = 50), col = "black") + geom_segment(aes(x = 1.5, xend = 1.5, y = 50, yend = 45), col = "black") + geom_segment(aes(x = 3.5, xend = 3.5, y = 50, yend = 45), col = "black")
